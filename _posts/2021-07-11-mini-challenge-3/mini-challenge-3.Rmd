---
title: "Mini-challenge 3"
description: |
  A short description of the post.
author:
  - name: Qian Ziwei
    url: https://example.com/norajones
date: 07-11-2021
output:
  distill::distill_article:
    self_contained: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(fig.retina = 3,
                      echo = TRUE,
                      eval = TRUE,
                      message = FALSE,
                      warning = FALSE)
```

# 1. Overview

---

### 1.1 Background

In the country island of Kronos, the increasing noxious effects on health and farming have been related to the uncontrolled activity of GAStech, a natural gas operator, supported by corrupt government officials. On January 20th, 2014, a corporate meeting is held to celebrate the new-found fortune because of the initial public offering of the company. However, a series of rare events occur that lead to the disappearance of several employees. The Protectors of Kronos (POK), a social movement organization that has been fighting against water contamination and government corruption, is suspected in the disappearance.

As analysts, we were assigned with several tasks in order to identify risks and how they could have been mitigated more effectively.

### 1.2 Literature review


### 1.3 Objective

Using data and visual analytics to evaluate the changing levels of risk to the public and recommend actions for first responder:

* Distinguish meaningful event reports from typical chatter from junk or spam.

* Evaluate the level of the risk to the public evolves over the course of the evening. Consider the potential consequences of the situation and the number of people who could be affected.
Determine the appropriate location for first responders.

* The differences between dealing with this challenge in 2014 and dealing with it now.

### 1.4 Question 1

### 1.5 Question 2

### 1.6 Question 3

### 1.7 Question 4


---

# 2. Building the visualization

---

### 2.1 Setting up the environment/packages

First, we run this fist line of code to clear the environment and remove existing R objects(if any).

```{r}
rm(list = ls())
```

This code chunk checks if required packages are installed. If they are not installed, the next line of code will install them. The following line is then use to import the library into the current working environment.

```{r}
packages = c('readr','tidytext','data.table','lubridate','ggplot2',
             'caret','dplyr','tidyr','scales','quanteda','textdata',
             'stringr','stringi','reshape2','RColorBrewer','wordcloud',
             'forcats','igraph','ggraph','widyr','clock','knitr','tidyverse',
             'DT','hms')
for(p in packages){
  if(!require(p,character.only = TRUE)){
    install.packages(p)
  }
  library(p,character.only = TRUE)
}
```

### 2.2 Importing data and changing data type

First, use <font color = blue>*read_csv()* </font> to import the csv file. 

```{r}
read1 <- read_csv("F:/visual/assignment and project/MC3/MC3/csv-1700-1830.csv",
                  col_types = list(col_character(),col_character(),col_character(),
                                   col_character(),col_double(),col_double(),
                                   col_character()))
read2 <- read_csv("F:/visual/assignment and project/MC3/MC3/csv-1831-2000.csv",
                  col_types = list(col_character(),col_character(),col_character(),
                                   col_character(),col_double(),col_double(),
                                   col_character()))
read3 <- read_csv("F:/visual/assignment and project/MC3/MC3/csv-2001-2131.csv",
                  col_types = list(col_character(),col_character(),col_character(),
                                   col_character(),col_double(),col_double(),
                                   col_character()))
```
Using function <font color = blue>*rbind()* </font> combine these three csv files with the same format.

```{r}
df <- rbind.data.frame(read1,read2,read3)
glimpse(df)
DT::datatable(df,filter = 'top',
              extensions = 'Buttons',
              options = list(autoWidth = TRUE, columnDefs = list(list(width = '400px', targets = c(4))), dom='Bfrtip',
                             buttons=c('copy', 'csv', 'excel', 'print', 'pdf'))) 
```

From the above table the <font color = red>*date(yyyyMMddHHmmss)*</font> is not in time format, so converting to date-time field. Because in the mini-challenge 3, all activities occur on the same day.Extract time(hms) data without date and transform.

```{r}
df$`date(yyyyMMddHHmmss)` <- date_time_parse(df$`date(yyyyMMddHHmmss)`,
                                 zone = "",
                                 format = "%Y%m%d %H%M%S")
df$time <- as_hms(ymd_hms((df$`date(yyyyMMddHHmmss)`)))
glimpse(df)
DT::datatable(df,filter = 'top',
              extensions = 'Buttons',
              options = list(autoWidth = TRUE, columnDefs = list(list(width = '400px', targets = c(4))), dom='Bfrtip',
                             buttons=c('copy', 'csv', 'excel', 'print', 'pdf')))
```

### 2.3 Question 1

#### 2.3.1 Data processing
In question 1, extract the required data from the <font color = red>*df*</font> to make a new data frame. After reading all the data carefully, the terminology of <font color = red>*mbdata*</font> and <font color = red>*ccdata*</font> is very different, so separate the two files. Since ccdata is a police or fire department record, this dataset is labeled as a meaningful dataset.

```{r}
df1 <- subset(df, select = c("type","author","message"))
df_m <- subset(df1, type == "mbdata")
df_cc <- subset(df1,type == "ccdata")
df_cc$condition <- "meaningful"
DT::datatable(df_cc,extensions = 'Buttons',
              options = list(autoWidth = TRUE, columnDefs = list(list(width = '400px', targets = c(4))), dom='Bfrtip',
                             buttons=c('copy', 'csv', 'excel', 'print', 'pdf')))
```
